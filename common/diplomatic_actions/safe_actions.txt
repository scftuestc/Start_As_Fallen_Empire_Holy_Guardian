# Variables:
# is_listed, boolean, decides if this diplomactic action type is listed in diplomatic view.
# prerequisites, list, the technologies required to enable the player to send this diplomatic action.
# requires_actor_peace, boolean, false by default, will require the actor to be at peace for this action to pass the possible check.
# requires_alliance_vote, boolean, false by default, will require the alliance of the actor to vote for this action before passing it on to the recipient.
# requires_actor_independence, boolean, true by default, will require the actor to be independent.
# requires_recipient_independence, boolean, true by default, will require the recipient to be independent.
# requires_actor_federation_leader, boolean, false by default, if the actor is in a federation, he has to be the leader of it.
# requires_recipient_federation_leader, boolean, true by default, if the recipient is in a federation, he has to be the leader of it.
# show_decline_to_alliance_members, boolean, false by default, will show your alliance members when you decline a proposal of this type.
# should_show_accept_message, decides whether actor gets a response on acceptance (otherwise just on decline)
# should_remove_response_message_when_not_possible, boolean, decides if diplomatic response messages should be removed when the 'possible' check fails.
# should_show_auto_accept_message_recipient, boolean, decides if the recipient gets a message showing the diplomatic action.
# should_open_auto_accept_message_recipient, boolean, decides if the recipient automatically opens this message.
# should_notify_auto_recipient_on_vote_fail, boolean, decides if recipient is notified of vote failure if action was auto accepted.
# should_show_auto_accept_message_actor, boolean, decides if the actor gets a reply showing the diplomatic action.
# should_notify_all_communications, boolean, decides if a message notification is sent to all countries who have communications with actor or recipient
# sound, string, can be used to pick a custom OnAccept sound, optional
# AI_acceptance_base_value, default = 0
# potential, trigger, root is actor, from is recipient, decides if the action is shown
# possible, trigger, root is actor, from is recipient, prev is either requester (if action is done in response to an ask_xxx counterpart) or same as root, decides if the action is still possible
# proposable, trigger, root is actor, from is recipient, decides if the action is proposable
# ai_acceptance: weight field where you can define AI reasons to accept or reject the proposal. root is recipient, from is actor. Does not overwrite hardcoded reasons, and only using add and subtract is recommended, since multiplication won't affect reasons outside the ai_acceptance field


@cb_subjugation_length = 360

# 让普通，堕落，觉醒都可以发起间谍行动，管理间谍网
# Build Spy Network
# 如果hidden_trigger内的所有条件都满足，那么这个外交选项、决议、事件选项等会显示给玩家。
# 如果hidden_trigger内有任何一个条件不满足，那么这个选项根本不会出现在玩家的选择列表里。

action_build_spy_network = {
    icon = "GFX_envoy_action_build_spy_network"
    auto_accepted = yes
    require_envoy = yes
    envoy_assignment = spy_network
    requires_actor_independence = no
    requires_recipient_independence = no
    action_type = positive
    sound = fc_ui_spy_network_button

    potential = {
        hidden_trigger = {
            OR = {
                is_country_type = default
                is_country_type = fallen_empire
                is_country_type = awakened_fallen_empire
            }
            from = {
                OR = {
                    is_country_type = default
                    AND = {
                        is_country_type = primitive
                        observation_owner_is_actor = yes
                    }
                    AND = {
                        is_galactic_emperor = yes
                        has_country_flag = fallen_empire_hive_control
                        root = { is_galactic_community_member = yes }
                    }
                }
                NOR = {
                    has_country_flag = fotd_seperatist_country
                    AND = {
                        has_country_flag = solarpunk_country
                        is_country_type = primitive
                    }
                    #  如果发起者是普通帝国，则目标不能是堕落帝国或觉醒帝国
                    AND = {
                        ROOT = { is_country_type = default }
                        OR = {
                            is_country_type = fallen_empire
                            is_country_type = awakened_fallen_empire
                        }
                    }
                }
            }
        }
    }

    possible = {
        custom_tooltip = {
            fail_text = "diplomacy_wrong_interference_policy"
            OR = {
                from = { is_country_type = default }
                from = { is_fallen_empire = yes }
                AND = {
                    from = { is_country_type = primitive }
                    NOT = { has_policy_flag = interference_not_allowed }
                }
            }
        }
        custom_tooltip = {
            fail_text = "BLANK_STRING"
            if = { limit = { from = { is_primitive = no } }
                from = {
                    OR = {
                        is_fallen_empire = no
                        AND = {
                            is_galactic_emperor = yes
                            has_country_flag = fallen_empire_hive_control
                            root = { is_galactic_community_member = yes }
                        }
                    }
                }
            }
        }
    }
}

# Manage Spy Network
action_manage_spy_network = {
    icon = "GFX_envoy_action_build_spy_network"
    auto_accepted = yes
    requires_actor_independence = no
    requires_recipient_independence = no
    action_type = neutral
    sound = fc_ui_spy_network_button

    potential = {
        hidden_trigger = {
            OR = {
                is_country_type = default
                is_country_type = fallen_empire
                is_country_type = awakened_fallen_empire
            }
            from = {
                OR = {
                    is_country_type = default
                    AND = {
                        is_country_type = primitive
                        observation_owner_is_actor = yes
                    }
                    AND = {
                        is_galactic_emperor = yes
                        has_country_flag = fallen_empire_hive_control
                        root = { is_galactic_community_member = yes }
                    }
                }
            }
        }
    }

    possible = {
        custom_tooltip = {
            fail_text = "diplomacy_wrong_interference_policy"
            OR = {
                from = { is_country_type = default }
                from = { is_fallen_empire = yes }
                AND = {
                    from = { is_country_type = primitive }
                    NOT = { has_policy_flag = interference_not_allowed }
                }
            }
        }
        custom_tooltip = {
            fail_text = "BLANK_STRING"
            if = { limit = { from = { is_primitive = no } }
                from = {
                    OR = {
                        is_fallen_empire = no
                        AND = {
                            is_galactic_emperor = yes
                            has_country_flag = fallen_empire_hive_control
                            root = { is_galactic_community_member = yes }
                        }
                    }
                }
            }
        }
    }
}