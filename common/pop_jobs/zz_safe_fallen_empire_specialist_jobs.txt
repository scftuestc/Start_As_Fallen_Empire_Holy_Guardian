## 原版堕落的岗位不做改动，加前缀safe重写
## possible 中均做了限制，只有初始物种才能从事，符合条件的可以按权重转职

#-----------------SPECIALIST------------------#
## 对应于普通帝国的商贩
safe_fe_trader = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_market_2
            icon = trader
        }
    }

    tags = { trade amenities }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }
    possible = {
        exists = owner
        owner = {
            is_fallen_empire_spiritualist = yes
            has_origin = Start_As_Fallen_Empire_Holy_Guardians
        }
        is_same_species = owner
    }

    possible_precalc = can_fill_specialist_job

    resources = {
        category = planet_safe_fe_traders

        produces = {
            trade = 20
        }
        upkeep = {
            consumer_goods = 1.5
        }
    }

    overlord_resources = {
        category = planet_corporate_franchising_meddling
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_franchise_headquarters
                }
            }
            unity = 1
        }
    }

    triggered_planet_modifier = {
        potential = {
            exists = owner
            owner = { has_tradition = tr_mercantile_commercial_enterprise }
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    triggered_planet_modifier = {
        potential = {
            exists = planet
            planet = {
                exists = orbital_defence
                orbital_defence = {
                    exists = starbase
                    starbase = {
                        has_starbase_building = ring_trade_hub
                    }
                }
            }
        }
        planet_amenities_add = 100
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    weight = {
        weight = @specialist_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_trader|RESOURCE|trade|
        mult = value:scripted_modifier_job_weight_mult|MODIFIER|pop_job_amenities_mult|
        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
            OR = { # contingency won't purge itself
                NOT = { exists = event_target:custodian_bot }
                AND = {
                    exists = event_target:custodian_bot
                    NOT = { species = { is_same_value = event_target:custodian_bot } }
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_trade"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = specialist
                AMOUNT = local_pop_amount
            }
        }
    }
}

## 对应于普通帝国的演艺人员
safe_fe_entertainer = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_entertainment_2
            icon = entertainer
        }
        # 转职
        swap_type = {
            trigger = {
                entertainer_is_duelist_trigger = yes
                entertainer_is_storm_dancer_trigger = no
            }
            name = safe_fe_duelist
            desc = job_safe_fe_duelist_desc
            icon = safe_fe_duelist
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 5
        }
        swap_type = {
            trigger = {
                entertainer_is_duelist_trigger = no
                entertainer_is_storm_dancer_trigger = yes
            }
            name = storm_dancer
            desc = storm_dancer
            icon = storm_dancer
            building_icon = building_storm_summoning_theater
            weight = 5
        }
        swap_type = {
            trigger = {
                entertainer_is_curator_trigger = yes
            }
            name = curator
            desc = curator
            icon = historical_curator
            building_icon = aesthetic_wonders_holomuseum
            weight = 10
        }
        swap_type = {
            trigger = {
                entertainer_is_duelist_trigger = yes
                entertainer_is_storm_dancer_trigger = yes
            }
            name = storm_duelist
            desc = storm_duelist
            icon = duelist
            building_icon = building_storm_summoning_theater
            condition_string = BATTLE_THRALL_JOB_TRIGGER
            weight = 20
        }
    }

    tags = { amenities unity }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible = {
        exists = owner
        owner = {
            is_fallen_empire_spiritualist = yes
            has_origin = Start_As_Fallen_Empire_Holy_Guardians
        }
        is_same_species = owner

        if = {
            limit = {
                entertainer_is_duelist_trigger = yes
            }
            battle_thrall_job_check_trigger = yes
        }
        else = {
            entertainer_job_check_trigger = yes
        }
    }

    resources = {
        category = planet_safe_fe_entertainers

        produces = {
            unity = 5
        }
        upkeep = {
            trigger = {
                entertainer_is_duelist_trigger = no
            }
            consumer_goods = 1
        }
        # 转职为决斗者后的产出
        produces = {
            trigger = {
                entertainer_is_duelist_trigger = yes
            }
            unity = 1
        }
        upkeep = {
            trigger = {
                entertainer_is_duelist_trigger = yes
                entertainer_is_storm_dancer_trigger = no
            }
            alloys = 0.5
        }
        # 转职为风暴舞者后的产出
        produces = {
            trigger = {
                entertainer_is_storm_dancer_trigger = yes
            }
            unity = 3
        }
        upkeep = {
            trigger = {
                entertainer_is_storm_dancer_trigger = yes
                entertainer_is_duelist_trigger = no
            }
            consumer_goods = 1
        }
        # 转职为风暴决斗者后的维护费
        upkeep = {
            trigger = {
                entertainer_is_storm_dancer_trigger = yes
                entertainer_is_duelist_trigger = yes
            }
            alloys = 1
        }
    }

    ## 舒适度产出
    triggered_planet_modifier = {
        potential = {
            always = yes
        }
        planet_amenities_add = 1250
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    ## 决斗者产出
    triggered_country_modifier = {
        potential = {
            entertainer_is_duelist_trigger = yes
        }
        country_naval_cap_add = 2
    }

    triggered_planet_modifier = {
        potential = {
            entertainer_is_duelist_trigger = yes
            exists = owner
            owner = {
                has_councilor = { COUNCILOR = "councilor_warrior_culture" }
            }
        }
        planet_amenities_add = 100
        mult = value:scripted_modifier_councilor_level_mult|MODIFIER|pop_job_amenities_mult|TYPE|councilor_warrior_culture|
    }

    triggered_country_modifier = {
        potential = {
            entertainer_is_duelist_trigger = yes
            has_councilor = { COUNCILOR = "councilor_warrior_culture" }
        }

        country_naval_cap_add = 0.2
        mult = value:councilor_level|TYPE|councilor_warrior_culture|
    }

    triggered_planet_modifier = {
        potential = {
            exists = owner
            owner = {
                has_modifier = exploitation_accord
            }
        }
        planet_jobs_produces_mult = @accord_exploitation_resources_from_jobs
    }

    weight = {
        weight = @high_prio_specialist_job_weight
        mult = value:job_weights_modifier|JOB|safe_fe_entertainer|RESOURCE|unity|FACTOR|0.25|
        mult = value:scripted_modifier_job_weight_mult|MODIFIER|pop_job_amenities_mult|

        modifier = {
            factor = 50
        }
        modifier = {
            add = 500
            exists = planet
            planet = {
                has_modifier = artistic_boom
            }
        }
        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_charisma"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}
# 转职（决斗者）
safe_fe_duelist = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_entertainment_2
            icon = duelist
        }
    }
    possible = { always = no }
}

## 对应于普通帝国的灵能使
safe_fe_augur = {
    category = precursor_artisan
    is_capped_by_modifier = yes
    can_be_automated = no

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_empyrean_shrine
            icon = telepath
        }
        # 转职
        swap_type = {
            trigger = {
                enforcer_is_educator_trigger = yes
            }
            name = educator_telepath
            desc = educator_telepath
            icon = telepath
            building_icon = building_psi_corps
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 10
        }
    }

    tags = { crime enforcer unity telepath psionic_aura }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
        has_psionic_species_trait = yes
    }

    triggered_planet_modifier = {
        potential = { always = yes }
        planet_crime_add = -10
        planet_defense_armies_add = 4
    }

    resources = {
        category = planet_safe_fe_augur
        produces = {
            unity = 10
            society_research = 2
        }
        produces = {
            trigger = {
                exists = owner
                owner = { has_active_tradition = tr_domination_judgment_corps }
            }
            unity = 1
        }
        # 与虚境通信签订契约后的加成
        produces = {
            trigger = {
                exists = owner
                owner = { has_country_flag = whisperers_covenant_confirmed }
            }
            physics_research = 5
            engineering_research = 5
            society_research = 5
        }
        produces = {
            trigger = {
                exists = owner
                owner = { has_country_flag = whisperers_covenant_rank_1 }
            }
            physics_research = 5
            engineering_research = 5
            society_research = 5
        }
        upkeep = {
            sr_zro = 0.25
        }
        upkeep = {
            trigger = {
                exists = planet
                planet = { has_modifier = anticrime_campaign }
            }
            energy = 2
        }
    }

    inline_script = "jobs/job_enforcer_additional_modifiers"
    inline_script = "jobs/job_telepath_additional_modifiers"

    weight = {
        weight = @specialist_job_weight

        mult = 2
        mult = value:job_weights_modifier|JOB|safe_fe_augur|RESOURCE|unity|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_unity"
}

## 对应于普通帝国的官僚，对于圣卫将转职为祭司
safe_fe_bureaucrat = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            icon = bureaucrat
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_administration_2
        }
        # 转职
        swap_type = {
            trigger = {
                bureaucrat_is_priest = yes
            }
            name = safe_fe_priest
            desc = safe_fe_priest
            icon = priest
            building_icon = building_fe_temple_2
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 5
        }
        swap_type = {
            trigger = {
                bureaucrat_is_numistic_priest = yes
            }
            name = safe_fe_numistic_priest
            desc = job_safe_fe_numistic_priest_desc
            icon = safe_fe_numistic_priest
            building_icon = building_nuumismatic_shrine
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 20
        }
        swap_type = {
            trigger = {
                bureaucrat_is_culture_worker = yes
            }
            name = safe_fe_culture_worker
            desc = job_safe_fe_culture_worker_desc
            icon = safe_fe_culture_worker
            building_icon = building_artist_patron
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 30
        }
        swap_type = {
            trigger = {
                bureaucrat_is_death_priest = yes
            }
            name = death_priest
            desc = death_priest
            icon = death_priest
            building_icon = building_sacrificial_temple_1
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 35
        }
        swap_type = {
            trigger = {
                bureaucrat_is_memorialist = yes
            }
            name = safe_fe_death_chronicler
            desc = job_safe_fe_death_chronicler_desc
            icon = safe_fe_death_chronicler
            building_icon = building_galactic_memorial_1
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 200
        }
        swap_type = {
            trigger = {
                bureaucrat_is_superstitious_beliefs_priest = yes
            }
            name = superstitious_beliefs_priest
            desc = superstitious_beliefs_priest
            icon = superstitious_beliefs_priest
            building_icon = building_temple
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 500
        }
    }

    tags = { unity }

    triggered_tags = {
        trigger = {
            OR = {
                bureaucrat_is_priest = yes
                bureaucrat_is_death_priest = yes
                bureaucrat_is_numistic_priest = yes
                bureaucrat_is_superstitious_beliefs_priest = yes
            }
        }
        tags = { psionic_aura }
    }


    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = {
            is_fallen_empire_spiritualist = yes
            has_origin = Start_As_Fallen_Empire_Holy_Guardians
        }
        complex_specialist_job_check_trigger = yes
        is_same_species = owner
    }

    resources = {
        category = planet_safe_fe_bureaucrats
        # PRODUCES
        produces = {
            unity = 10
        }
        upkeep = {
            consumer_goods = 2
        }
        # 转职为死亡祭司后的产出
        produces = {
            trigger = {
                bureaucrat_is_death_priest = yes
            }
            unity = -1
            society_research = 1
        }
        produces = {
            trigger = {
                bureaucrat_is_death_priest = yes
                exists = owner
                owner = { has_sacrificial_edict = yes }
            }
            unity = 3
        }
        # 转职为拜金教祭司后的产出
        produces = {
            trigger = {
                exists = planet
                planet = {
                    bureaucrat_is_numistic_priest = yes
                }
            }
            unity = -2
            trade = 6
        }
        # 转职为灵媒后的产出
        produces = {
            trigger = {
                bureaucrat_is_superstitious_beliefs_priest_corporate = yes
            }
            unity = -1
            trade = 6
        }

        inline_script = "jobs/ethic_job_resources_memorialist"
    }

    # 舒适度产出
    triggered_planet_modifier = {
        potential = {
            bureaucrat_is_priest = yes
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            bureaucrat_is_death_priest = yes
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            bureaucrat_is_numistic_priest = yes
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            bureaucrat_is_culture_worker = yes
        }
        planet_amenities_add = 300
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    inline_script = "jobs/ethic_job_modifiers_memorialist"

    # 稳定度产出
    triggered_planet_modifier = {
        potential = { bureaucrat_is_memorialist = yes }
        planet_stability_add = 0.5
    }
    triggered_planet_modifier = {
        potential = { bureaucrat_is_superstitious_beliefs_priest = yes }
        planet_stability_add = 1
    }
    triggered_planet_modifier = {
        potential = {
            exists = planet
            planet = {
                check_modifier_value = {
                    modifier = planet_bureaucrats_stability_produces_add
                    value > 0
                }
            }
        }
        planet_stability_add = 1
        mult = planet.modifier:planet_bureaucrats_stability_produces_add
    }

    # 转职为文化工作者后的主流思潮吸引力效果
    triggered_planet_modifier = {
        potential = {
            bureaucrat_is_culture_worker = yes
        }
        pop_government_ethic_attraction = 0.10
    }

    triggered_planet_modifier = {
        potential = {
            planet = {
                has_active_building = building_league_offices
            }
        }
        planet_amenities_add = 100
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    triggered_country_modifier = {
        potential = {
            exists = owner
            owner = { has_valid_civic = civic_efficient_bureaucracy }
        }
        country_edict_fund_add = 2
        mult = value:job_total_output_modifier|JOB|safe_fe_bureaucrat|RESOURCE|unity|
    }

    weight = {
        weight = @specialist_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_bureaucrat|RESOURCE|unity|
        mult = value:scripted_modifier_job_weight_mult|MODIFIER|pop_job_amenities_mult|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_unity"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}

# 转职（拜金教祭司）
safe_fe_numistic_priest = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_nuumismatic_shrine
            icon = numistic_priest
        }
    }

    possible = { always = no }
}
# 转职（文化工作者）
safe_fe_culture_worker = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_autochthon_monument
            icon = culture_worker
        }
    }
    possible = { always = no }
}
# 转职（死亡录书官）
safe_fe_death_chronicler = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_galactic_memorial_1
            icon = death_chronicler
        }
    }

    possible = { always = no }

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}

## 圣卫中用于替换平民的阶层，设置为只有AI能用
fe_acolyte_artisan = {
    category = precursor
    is_capped_by_modifier = no

    swappable_data = {
        default = {
            building_icon = building_empyrean_shrine
            icon = artisan
        }
    }

    tags = { consumer_goods }

    possible_pre_triggers = {
        has_owner = yes
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        owner = {
            has_ethic = ethic_fanatic_spiritualist
            NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        }
        is_same_species = owner
    }

    triggered_planet_modifier = {
        potential = {
            always = yes
        }
        planet_amenities_add = 300
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    resources = {
        category = planet_jobs
        produces = {
            consumer_goods = 6
        }
        produces = {
            trigger = {
                planet = { has_active_building = building_factory_2 }
            }
            consumer_goods = 1
        }
        produces = {
            trigger = {
                planet = { has_active_building = building_factory_3 }
            }
            consumer_goods = 2
        }
    }

    weight = {
        weight = @worker_job_weight

        # No Player
        modifier = {
            factor = 0
            exists = owner
            owner = {
                OR = {
                    has_origin = Start_As_Fallen_Empire_Holy_Guardians
                    is_ai = no
                }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }
}

## 对应于普通帝国的工匠
safe_fe_acolyte_artisan = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_affluence_center
            icon = artisan
        }
        # 转职
        swap_type = {
            trigger = {
                artisan_is_artificer_trigger = yes
            }
            name = safe_fe_artificer
            desc = job_safe_fe_artificer_desc
            icon = safe_fe_artificer
            weight = 5
        }
        swap_type = {
            trigger = {
                artisan_is_pearl_diver_trigger = yes
            }
            name = pearl_diver
            desc = pearl_diver
            icon = pearl_diver
            building_icon = building_food_processing_facility
            weight = 5
        }
        swap_type = {
            trigger = {
                artisan_is_artificer_trigger = yes
                artisan_is_pearl_diver_trigger = yes
            }
            name = pearl_crafter
            desc = pearl_crafter
            icon = pearl_diver
            building_icon = building_food_processing_facility
            weight = 10
        }
    }

    tags = { consumer_goods }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
    }

    # 舒适度产出
    triggered_planet_modifier = {
        potential = {
            always = yes
        }
        planet_amenities_add = 300
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    resources = {
        category = planet_safe_fe_acolyte_artisan
        produces = {
            consumer_goods = 10
        }
        produces = {
            trigger = {
                planet = { has_active_building = building_factory_2 }
            }
            consumer_goods = 1
        }
        produces = {
            trigger = {
                planet = { has_active_building = building_factory_3 }
            }
            consumer_goods = 2
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = no
            }
            minerals = 5
        }
        # 转职为熟练技工后的产出
        produces = {
            trigger = {
                artisan_is_artificer_trigger = yes
            }
            consumer_goods = 2
            trade = 2
        }
        # 转职为珍珠潜水员后的产出（受到有无行星总督的修正影响）
        produces = {
            trigger = {
                exists = planet
                planet = {
                    artisan_is_pearl_diver_trigger = yes
                }
            }
            trade = 2
        }
        produces = {
            trigger = {
                exists = planet
                planet = {
                    artisan_is_pearl_diver_trigger = yes
                }
                has_councilor = { COUNCILOR = "councilor_anglers" }
            }
            consumer_goods = @councilor_anglers_pearl_diver_consumer_goods_bonus
            mult = value:councilor_level|TYPE|councilor_anglers|
        }
        produces = {
            trigger = {
                exists = planet
                planet = {
                    artisan_is_pearl_diver_trigger = yes
                }
                has_councilor = { COUNCILOR = "councilor_machine_anglers" }
            }
            consumer_goods = @councilor_machine_anglers_pearl_diver_consumer_goods_bonus
            mult = value:councilor_level|TYPE|councilor_machine_anglers|
        }
        # 采用催化加工国策后的产出
        produces = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
            }
            consumer_goods = 1.5
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
            }
            food = 8
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
                exists = planet
                planet = {
                    artisan_is_pearl_diver_trigger = yes
                }
            }
            minerals = 2
            food = -3
        }
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_produce_requisitorium
                    exists = owner.overlord
                    owner.overlord = { country_uses_consumer_goods = yes }
                }
            }
            consumer_goods = @requisitorium_consumer_goods_reduction
        }
        upkeep = {
            trigger = {
                planet = {
                    has_planet_flag = has_produce_requisitorium
                    exists = owner.overlord
                    owner.overlord = { country_uses_consumer_goods = yes }
                }
            }
            minerals = 1
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
                planet = {
                    has_planet_flag = has_produce_requisitorium
                    exists = owner.overlord
                    owner.overlord = { country_uses_consumer_goods = yes }
                }
            }
            food = 1.5
        }

        inline_script = "output/factory_output"
    }

    overlord_resources = {
        category = planet_requisitioned_consumer_goods
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_produce_requisitorium
                    exists = owner.overlord
                    owner.overlord = { country_uses_consumer_goods = yes }
                }
            }
            consumer_goods = @requisitorium_consumer_goods_overlord
        }
    }

    # 转职为珍珠潜水员后的舒适度产出
    triggered_planet_modifier = {
        potential = {
            artisan_is_pearl_diver_trigger = yes
            exists = owner
            owner = { has_valid_civic = civic_agrarian_idyll }
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    weight = {
        weight = @specialist_job_weight
        mult = value:job_weights_modifier|JOB|safe_fe_acolyte_artisan|RESOURCE|consumer_goods|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # low income modifier
        modifier = {
            factor = 1.2
            exists = planet
            planet = {
                has_available_jobs = "artisan"
            }
            exists = owner
            owner = {
                is_ai = yes
                has_monthly_income = {
                    resource = consumer_goods
                    value < 5
                }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_consumer_goods"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}
# 转职（熟练工匠）
safe_fe_artificer = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_affluence_center
            icon = artificer
        }
    }
    possible = { always = no }
}

## 对应于普通帝国的冶金师
safe_fe_foundry = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            icon = foundry
            building_icon = building_nano_forge
        }
        # 转职
        swap_type = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
            }
            name = safe_fe_catalytic_technician
            desc = job_catalytic_technician_desc
            icon = safe_fe_catalytic_technician
            weight = 5
        }
    }

    tags = { alloys }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
    }

    resources = {
        category = planet_safe_fe_foundry
        produces = {
            alloys = 10
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = no
            }
            minerals = 5
        }
        # 转职为催化技师后的产出与维护
        produces = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
            }
            alloys = 1
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
            }
            food = 8
        }
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_material_requisitorium
                }
            }
            alloys = @requisitorium_alloys_reduction
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = no
                planet = {
                    has_planet_flag = has_material_requisitorium
                }
            }
            minerals = 1
        }
        upkeep = {
            trigger = {
                industrial_jobs_are_catalytic_trigger = yes
                planet = {
                    has_planet_flag = has_material_requisitorium
                    has_building = building_ministry_production
                }
            }
            food = 2
        }
        inline_script = "output/foundry_output"
    }

    overlord_resources = {
        category = planet_requisitioned_alloys
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_material_requisitorium
                }
            }
            alloys = @requisitorium_alloys_overlord
        }
    }

    weight = {
        weight = @specialist_job_weight # Fairly important job
        mult = value:job_weights_modifier|JOB|safe_fe_foundry|RESOURCE|alloys|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_alloys"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}
# 转职（催化技师）
safe_fe_catalytic_technician = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_nano_forge
            icon = catalytic_technician
        }
    }
    tags = { alloys }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
    }

    possible = { always = no }

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}

# 对应于普通帝国的物理学家
safe_fe_physicist = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_lab_2
            icon = physicist
        }
        # 转职
        swap_type = {
            trigger = {
                physicist_is_astrometeorologist_trigger = yes
            }
            name = astrometeorologist
            desc = astrometeorologist
            icon = astrometeorologist
            building_icon = building_astrometeorology_observation_center
            condition_string = SPECIALIST_JOB_TRIGGER
            weight = 5
        }
        swap_type = {
            trigger = {
                physicist_is_astral_researcher_trigger = yes
            }
            name = astral_researcher
            desc = astral_researcher
            icon = astral_researcher
            building_icon = building_astral_siphon_1
            weight = 5
        }
        swap_type = {
            trigger = {
                physicist_is_space_time_researcher_trigger = yes
            }
            name = space_time_anomaly_researcher
            desc = space_time_anomaly_researcher
            weight = 10
        }
        swap_type = {
            trigger = {
                physicist_is_dimensional_portal_researcher_trigger = yes
            }
            name = dimensional_portal_researcher
            desc = dimensional_portal_researcher
            weight = 15
        }
        swap_type = {
            trigger = {
                physicist_is_astral_researcher_trigger = yes
                physicist_is_astrometeorologist_trigger = yes
            }
            name = astral_meteorologist
            desc = astral_meteorologist
            icon = astrometeorologist
            building_icon = building_astral_siphon_1
            weight = 20
        }
    }

    tags = { research }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
        complex_specialist_job_check_trigger = yes
    }

    triggered_country_modifier = {
        potential = {
            local_or_sector_governor_has_trait = {
                TRAIT = leader_trait_academia_recruiter
            }
        }
        country_naval_cap_add = 2
        mult = planet.modifier:job_researcher_naval_cap_add
    }

    resources = {
        category = planet_safe_fe_physicists

        produces = {
            physics_research = 15
        }
        upkeep = {
            consumer_goods = 1.5
        }
        # 转职为星际气象学家的产出
        produces = {
            trigger = {
                exists = planet
                planet = {
                    physicist_is_astrometeorologist_trigger = yes
                    solar_system = {
                        OR = {
                            has_environmental_effects = yes
                            has_star_flag = storm_system
                        }
                    }
                }
            }
            physics_research = 4
        }
        # 转职为时空异象研究员的产出
        produces = {
            trigger = {
                physicist_is_space_time_researcher_trigger = yes
            }
            physics_research = 2
            sr_dark_matter = 0.2
        }
        upkeep = {
            trigger = {
                physicist_is_space_time_researcher_trigger = yes
            }
            consumer_goods = 1.5
        }
        # 这个内联脚本为什么是空的？
        inline_script = "output/researcher_output"
    }

    overlord_resources = {
        category = planet_requisitioned_research
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_science_ministry
                }
            }
            physics_research = 1.5
        }
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_science_ministry
                    physicist_is_astrometeorologist_trigger = yes
                    solar_system = {
                        OR = {
                            has_environmental_effects = yes
                            has_star_flag = storm_system
                        }
                    }
                }
            }
            physics_research = 2
        }
    }

    # Dimensional Portal Amenities
    triggered_planet_modifier = {
        potential = {
            planet = {
                has_modifier = dportal_trade_normal
            }
        }
        planet_amenities_add = 600
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            planet = {
                has_modifier = dportal_trade_high
            }
        }
        planet_amenities_add = 1200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            planet = {
                has_modifier = dportal_trade_low
            }
        }
        planet_amenities_add = 300
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }
    triggered_planet_modifier = {
        potential = {
            planet = {
                has_modifier = dportal_trade_crisis
            }
        }
        planet_amenities_add = 200
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    weight = {
        weight = @specialist_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_physicist|RESOURCE|physics_research|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        modifier = {
            factor = 2
            has_living_standard = { type = living_standard_academic_privilege }
        }
    }

    inline_script = "jobs/automodding_priority_research"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}

# 对应于普通帝国的生物学家
safe_fe_biologist = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon =  building_fe_lab_2
            icon = biologist
        }
        # 转职
        swap_type = {
            trigger = {
                biologist_is_ranger_trigger = yes
            }
            name = ranger
            desc = ranger
            icon = ranger
            building_icon = holding_park_ranger_lodge
            weight = 5
        }
        swap_type = {
            trigger = {
                biologist_is_vent_researcher_trigger = yes
            }
            name = stratovent_researcher
            desc = stratovent_researcher
            icon = xeno_zoo_keeper
            building_icon = building_nanolab_1
            weight = 10
        }
        swap_type = {
            trigger = {
                biologist_is_zookeeper_trigger = yes
            }
            name = safe_fe_xeno_zoo_keeper
            desc = job_safe_fe_xeno_zoo_keeper_desc
            icon = safe_fe_xeno_zoo_keeper
            building_icon = building_xeno_zoo
            weight = 15
        }
        swap_type = {
            trigger = {
                biologist_is_archaeo_engineer_trigger = yes
            }
            name = safe_fe_archaeoengineers
            desc = job_safe_fe_archaeoengineers_desc
            icon = safe_fe_archaeoengineers
            building_icon = building_archaeostudies_faculty
            weight = 20
        }
    }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
        complex_specialist_job_check_trigger = yes
    }

    triggered_country_modifier = {
        potential = {
            local_or_sector_governor_has_trait = {
                TRAIT = leader_trait_academia_recruiter
            }
        }
        country_naval_cap_add = 2
        mult = planet.modifier:job_researcher_naval_cap_add
    }

    resources = {
        category = planet_safe_fe_biologists

        produces = {
            society_research = 15
        }
        upkeep = {
            consumer_goods = 1.5
        }
        # 转职为动物饲养员的产出
        produces = {
            trigger = {
                biologist_is_zookeeper_trigger = yes
            }
            society_research = 2
        }
        upkeep = {
            trigger = {
                biologist_is_zookeeper_trigger = yes
            }
            consumer_goods = 0.5
        }

        inline_script = "output/researcher_output"
    }

    overlord_resources = {
        category = planet_requisitioned_research
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_science_ministry
                }
            }
            society_research = 1.5
        }
    }

    # 转职为护林员的舒适度产出
    triggered_planet_modifier = {
        potential = {
            biologist_is_ranger_trigger = yes
        }
        planet_amenities_add = 500
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    # 转职为喷口研究员的舒适度产出
    triggered_planet_modifier = {
        potential = {
            biologist_is_vent_researcher_trigger = yes
        }
        planet_amenities_add = 500
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }

    # 转职为动物饲养员的舒适度产出
    triggered_planet_modifier = {
        potential = {
            biologist_is_zookeeper_trigger = yes
        }
        planet_amenities_add = 300
        mult = value:zoo_keeper_amenity_output
    }

    weight = {
        weight = @specialist_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_biologist|RESOURCE|society_research|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        modifier = {
            factor = 2
            has_living_standard = { type = living_standard_academic_privilege }
        }
    }

    inline_script = "jobs/automodding_priority_research"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}
# 转职（动物饲养员）
safe_fe_xeno_zoo_keeper = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_xeno_zoo
            icon = xeno_zoo_keeper
        }
    }

    possible = { always = no }
}
# 转职（考古工程师）
safe_fe_archaeoengineers = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_archaeostudies_faculty
            icon = archaeoengineers
        }
    }

    tags = { research minor_artifacts }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible = { always = no }

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}

## 对应于普通帝国的工程学家
safe_fe_engineer = {
    category = precursor_artisan
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = SPECIALIST_JOB_TRIGGER
            building_icon = building_fe_lab_2
            icon = engineer
        }
        # 转职
        swap_type = {
            trigger = {
                engineer_is_manufactorium_scraper_trigger = yes
            }
            name = manufactorium_scraper
            desc = manufactorium_scraper
            icon = broken_shackles_scavenger
            building_icon = building_research_lab_1
            weight = 5
        }
        swap_type = {
            trigger = {
                engineer_is_munitions_decommissioner_trigger = yes
            }
            name = munitions_decommissioner
            desc = munitions_decommissioner
            icon = munitions_decommissioner
            building_icon = building_research_lab_1
            weight = 10
        }
    }

    possible_pre_triggers = {
        has_owner = yes
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_specialist_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
        complex_specialist_job_check_trigger = yes
    }

    triggered_country_modifier = {
        potential = {
            local_or_sector_governor_has_trait = {
                TRAIT = leader_trait_academia_recruiter
            }
        }
        country_naval_cap_add = 2
        mult = planet.modifier:job_researcher_naval_cap_add
    }

    resources = {
        category = planet_safe_fe_engineers

        produces = {
            engineering_research = 15
        }
        upkeep = {
            consumer_goods = 1.5
        }

        inline_script = "output/researcher_output"
    }

    overlord_resources = {
        category = planet_requisitioned_research
        produces = {
            trigger = {
                planet = {
                    has_planet_flag = has_science_ministry
                }
            }
            engineering_research = 1
        }
    }

    weight = {
        weight = @specialist_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_engineer|RESOURCE|engineering_research|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        modifier = {
            factor = 2
            has_living_standard = { type = living_standard_academic_privilege }
        }
    }

    inline_script = "jobs/automodding_priority_research"

    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_artisan
                AMOUNT = local_pop_amount
            }
        }
    }
}
