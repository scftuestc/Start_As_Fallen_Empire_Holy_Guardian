# 原版堕落的岗位不做改动，加前缀safe重写
# possible 中均做了限制，只有使用起源且初始物种才能从事该岗位，符合条件的可以按权重转职。

#-----------------RULER------------------#
## 对应于普通帝国的政客
safe_fe_sky_cardinal = {
    category = precursor_archon
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = RULER_JOB_TRIGGER
            icon = high_priest
            building_icon = building_palace
        }
        # 转职与相应权重比例
        swap_type = {
            trigger = {
                politician_is_noble = yes
            }
            name = safe_fe_noble
            icon = safe_fe_noble
            desc = job_safe_fe_noble_desc
            weight = 10
        }
        swap_type = {
            trigger = {
                politician_is_merchant = yes
            }
            name = safe_fe_merchant
            icon = safe_fe_merchant
            desc = job_safe_fe_merchant_desc
            weight = 10
        }
        swap_type = {
            trigger = {
                politician_is_planetary_warden = yes
            }
            name = safe_fe_warden
            icon = safe_fe_warden
            desc = job_safe_fe_warden_desc
            weight = 15
        }
        swap_type = {
            trigger = {
                politician_is_superstitious_beliefs_high_priest = yes
            }
            name = superstitious_beliefs_high_priest
            desc = superstitious_beliefs_high_priest
            icon = superstitious_beliefs_priest
            weight = 20
        }
    }


    tags = { amenities unity}

    triggered_tags = {
        trigger = { politician_is_superstitious_beliefs_high_priest = yes }
        tags = { psionic_aura }
    }


    possible_pre_triggers = {
        has_owner = yes
        is_enslaved = no
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_ruler_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
    }

    resources = {
        category = planet_safe_fe_sky_cardinal
        # 基本产出
        produces = {
            unity = 20
            trade = 4
            society_research = 3
        }
        # 通过国策转变为商人后的产出
        produces = {
            trigger = {
                exists = planet
                planet = {
                    OR = {
                        politician_is_merchant = yes
                        politician_is_augmentation_merchant = yes
                    }
                }
            }
            unity = -5
            trade = 7
        }
        # 转职为大占星师后的产出
        produces = {
            trigger = {
                exists = planet
                planet = {
                    politician_is_superstitious_beliefs_high_priest = yes
                }
            }
            unity = 2
        }

        upkeep = {
            consumer_goods = 2
            rare_crystals = 1
        }
    }

    planet_modifier = {
        planet_stability_add = 10
        pop_government_ethic_attraction = 0.1
    }

    triggered_planet_modifier = {
        potential = { always = yes }

        planet_amenities_add = 800
        mult = value:scripted_modifier_mult|MODIFIER|pop_job_amenities_mult|
    }


    weight = {
        weight = @ruler_job_weight

        mult = value:job_weights_modifier|JOB|safe_fe_sky_cardinal|RESOURCE|unity|
        mult = value:scripted_modifier_job_weight_mult|MODIFIER|pop_job_amenities_mult|

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }

    inline_script = "jobs/automodding_priority_charisma"

    # 人口晋升
    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_archon
                AMOUNT = local_pop_amount
            }
        }
    }
}
# 转职（贵族）
safe_fe_noble = {
    category = precursor_archon
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = RULER_JOB_TRIGGER
            building_icon = building_palace
            icon = noble
        }
    }

    possible = { always = no }
}
# 转职（商人）
safe_fe_merchant = {
    category = precursor_archon

    swappable_data = {
        default = {
            condition_string = RULER_JOB_TRIGGER
            building_icon = building_fe_market_2
            icon = merchant
        }
    }

    possible = { always = no }
}
# 转职（行星狱长）
safe_fe_warden = {
    category = precursor_archon

    swappable_data = {
        default = {
            condition_string = RULER_JOB_TRIGGER
            building_icon = building_palace
            icon = enforcer
        }
    }

    possible = { always = no }
}

## 对应于普通帝国的执行官
safe_fe_protector = {
    category = precursor_archon
    is_capped_by_modifier = yes

    swappable_data = {
        default = {
            condition_string = RULER_JOB_TRIGGER
            icon = enforcer
            building_icon = building_palace
        }
    }

    tags = { crime enforcer soldier }

    possible_pre_triggers = {
        has_owner = yes
        is_enslaved = no
        is_being_purged = no
        is_being_assimilated = no
        is_sapient = yes
    }

    possible_precalc = can_fill_ruler_job

    possible = {
        exists = owner
        owner = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
        is_same_species = owner
    }

    resources = {
        category = planet_safe_fe_protector
        produces = {
            unity = 10
        }
        upkeep = {
            consumer_goods = 1
        }
    }

    planet_modifier = {
        planet_crime_add = -50
        planet_stability_add = 3
    }

    inline_script = "jobs/job_enforcer_additional_modifiers"

    weight = {
        weight = @ruler_job_weight

        # No AI
        modifier = {
            factor = 0
            exists = planet
            exists = planet.controller
            planet.controller = {
                NOT = { has_origin = Start_As_Fallen_Empire_Holy_Guardians }
            }
        }
        # 当帝国中存在初始物种的亚种时，有这些特质的物种选择该岗位的权重会更高
        modifier = {
            factor = 2
            has_trait = trait_presapient_earthbound
        }
        modifier = {
            factor = 1.1
            has_trait = trait_limited_regeneration
        }
        modifier = {
            factor = 2
            has_trait = trait_resilient
        }
        modifier = {
            factor = 2
            has_trait = trait_very_strong
        }
        modifier = {
            factor = 1.5
            has_trait = trait_strong
        }
        # crisis purge
        modifier = {
            factor = 0.01
            exists = planet
            exists = planet.controller
            planet.controller = {
                OR = {
                    is_country_type = swarm
                    is_country_type = ai_empire
                }
            }
        }
    }
    # 人口晋升
    promotion = {
        time = @standard_promotion_time
        effect = {
            pop_amount_change_category = {
                CATEGORY = precursor_archon
                AMOUNT = local_pop_amount
            }
        }
    }
}
